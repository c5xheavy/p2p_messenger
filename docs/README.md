# P2P Messenger protocol

Байты численных типов кодируются от младшего к старшему - little-endian.  
Все величины переменной длины кодируются в виде числа с заданным числом байт, задающим длину величины в байтах, и самой величины.  

Сообщение отправляется как UDP-датаграмма.  
Первые 8 байт датаграммы занимает `id` сообщения, типа `uint64`.  
Следующий 1 байта датаграммы занимает `source_login_size` - длина логина пользователя, отправившего сообщение.  
Следующие `source_login_size` байта датаграммы занимает хэш логина пользователя, отправившего сообщение.  
Следующий 1 байта датаграммы занимает `destination_login_size` - длина логина пользователя, которому отправлено сообщение.  
Следующие `destination_login_size` байта датаграммы занимает хэш логина пользователя, которому отправлено сообщение.  
Следующие 2 байта датаграммы занимает `str_payload_size` - длина строкового представления JSON Payload.
Следующие `str_payload_size` байт датаграммы занимает строковое представление JSON Payload, хранящего в качестве своих полей все остальные данные сообщения.  

Схема JSON данных сообщения представлена в файле schema.json.  

Peer Discovery реализуется c использованием *Distributed Hash Table*.  
DHT будет хранить пары **хэш логина - IP:порт**.
